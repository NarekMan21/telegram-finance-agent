# Изменения в проекте Telegram Финансовый Агент

## Основные изменения

### 1. Изменение логики определения типа операций

Ранее система автоматически определяла тип операции (доход/расход) на основе ключевых слов в сообщении. Теперь тип операции определяется по группе, из которой пришло сообщение:

- Сообщения из группы, помеченной как "income" в конфигурации, считаются доходами
- Сообщения из группы, помеченной как "expense" в конфигурации, считаются расходами

### 2. Обновление конфигурационного файла

В [config.json](file:///E:/Новая%20папка/OKComputer_Telegram_/config.json) добавлена новая секция `group_types` для сопоставления ID групп с типами операций:

```json
{
    "api_id": 20517386,
    "api_hash": "73457be44439ae991e7ba2bf97820a31",
    "phone_number": "+79281307511",
    "group_ids": [
        -4884869527,
        -4855539306
    ],
    "group_types": {
        "-4884869527": "income",
        "-4855539306": "expense"
    },
    "web_server": {
        "host": "0.0.0.0",
        "port": 8080,
        "debug": false
    },
    "update_interval": 30,
    "currency": "RUB",
    "notifications": true,
    "auto_update": true
}
```

### 3. Изменения в коде

#### [telegram_parser.py](file:///E:/Новая%20папка/OKComputer_Telegram_/telegram_parser.py)

- Изменен метод `parse_financial_message` для определения типа операции на основе конфигурации групп
- Добавлена документация к методу `parse_financial_message`
- Исправлены ошибки типизации для совместимости с линтером

#### README файлы

- Обновлены [README.md](file:///E:/Новая%20папка/OKComputer_Telegram_/README.md) и [README_FULL_RU.md](file:///E:/Новая%20папка/OKComputer_Telegram_/README_FULL_RU.md) с информацией о новой конфигурации

### 4. Тестирование

Созданы и выполнены тесты для проверки новой функциональности:

- [test_group_types.py](file:///E:/Новая%20папка/OKComputer_Telegram_/test_group_types.py) - тестирование логики определения типа операций по группам
- [test_config_parsing.py](file:///E:/Новая%20папка/OKComputer_Telegram_/test_config_parsing.py) - тестирование с реальным конфигурационным файлом

## Преимущества изменений

1. **Более точное определение операций** - теперь тип операции определяется пользователем при настройке, а не автоматически
2. **Упрощенная настройка** - достаточно создать две группы (одну для доходов, другую для расходов) и указать их в конфигурации
3. **Более надежная система** - исключены ложные срабатывания при автоматическом определении типа операций

## Инструкция по использованию

1. Создайте две группы в Telegram:
   - Одну для фиксации доходов
   - Одну для фиксации расходов

2. Добавьте бота в обе группы

3. Получите ID групп с помощью @userinfobot

4. Обновите [config.json](file:///E:/Новая%20папка/OKComputer_Telegram_/config.json):
   - Добавьте ID групп в `group_ids`
   - Настройте сопоставление ID групп с типами операций в `group_types`

5. Запустите приложение