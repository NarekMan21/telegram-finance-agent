# Telegram Финансовый Агент

## Описание

Telegram Финансовый Агент - это автоматизированный инструмент для отслеживания финансовых операций в приватных группах Telegram. Агент подключается к указанным группам и захватывает все новые сообщения без уведомления других участников.

## Архитектура системы

### Компоненты

1. **Парсер Telegram** ([parser.py](file:///E:/ParserQ/parser.py))
   - Основной компонент для подключения к Telegram API
   - Аутентификация и управление сессией
   - Получение сообщений из указанных групп

2. **Сборщик данных** ([fetch_telegram_data.py](file:///E:/ParserQ/fetch_telegram_data.py))
   - Получает сообщения из групп Telegram
   - Классифицирует сообщения по группам (приходы/расходы)
   - Сохраняет данные в файл [transactions.json](file:///E:/ParserQ/transactions.json)

3. **Веб-сервер** ([run_full_system.py](file:///E:/ParserQ/run_full_system.py))
   - Обслуживает веб-интерфейс
   - Предоставляет API для доступа к данным
   - Отображает таблицы приходов и расходов

4. **Обновление данных** ([update_data.py](file:///E:/ParserQ/update_data.py))
   - Периодически запускает сборщик данных
   - Обновляет данные каждые 30 секунд

### Поток данных

```
Telegram Groups → Парсер → Сборщик данных → transactions.json → Веб-сервер → Браузер
```

## Конфигурация

### Файл конфигурации

Файл [config.json](file:///E:/ParserQ/config.json) содержит все необходимые настройки:

```json
{
    "api_id": 20517386,
    "api_hash": "73457be44439ae991e7ba2bf97820a31",
    "phone_number": "+79281307511",
    "group_ids": [
        -4884869527,
        -4855539306
    ]
}
```

### Классификация сообщений

Сообщения классифицируются по группам:
- Группа **-4855539306** → Приходы
- Группа **-4884869527** → Расходы

## API

### Конечные точки

- `GET /` - Главная страница с таблицами
- `GET /api/transactions` - Все транзакции
- `GET /api/transactions/income` - Приходы
- `GET /api/transactions/expense` - Расходы

### Формат данных

```json
{
  "income": [...],
  "expense": [...]
}
```

## Развертывание

### Требования

- Python 3.7+
- Зависимости из [requirements.txt](file:///E:/ParserQ/requirements.txt)

### Запуск

1. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

2. Настройте [config.json](file:///E:/ParserQ/config.json)

3. Запустите систему:
   ```bash
   python run_full_system.py
   ```

## Безопасность

- Все данные хранятся локально
- Файлы сессий зашифрованы
- Никакие данные не передаются на внешние серверы