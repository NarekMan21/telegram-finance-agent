# Изменения в формате хранения транзакций

## Новый формат хранения транзакций

Теперь транзакции сохраняются в формате, совместимом с ParserQ:

```json
{
  "income": [
    {
      "id": 61623,
      "timestamp": "2025-10-01T10:13:49+00:00",
      "group_id": -4855539306,
      "group_title": "ПРИХОД",
      "text": "10 нарек 55000",
      "sender_id": 541257249,
      "amount": 55000.0,
      "currency": "RUB",
      "description": "10 нарек 55000"
    }
  ],
  "expense": [
    {
      "id": 61624,
      "timestamp": "2025-10-01T10:13:57+00:00",
      "group_id": -4884869527,
      "group_title": "РАССХОД",
      "text": "37 нам 20000",
      "sender_id": 541257249,
      "amount": 20000.0,
      "currency": "RUB",
      "description": "37 нам 20000"
    }
  ],
  "last_updated": "2025-10-01T19:39:16.722981"
}
```

## Преимущества нового формата

1. **Совместимость** - Формат совместим с ParserQ, что позволяет использовать один и тот же файл транзакций
2. **Структурированность** - Доходы и расходы хранятся в отдельных массивах для удобства обработки
3. **Полнота данных** - Каждая транзакция содержит всю необходимую информацию
4. **Обратная совместимость** - Приложение может читать как старый, так и новый формат

## Изменения в коде

### 1. telegram_parser.py
- Метод `save_transactions` теперь сохраняет данные в формате ParserQ
- Добавлена конвертация из внутреннего формата в формат ParserQ
- Реализована проверка на дубликаты по ID транзакций

### 2. app.py
- Метод `load_existing_data` теперь может читать оба формата (старый и новый)
- При загрузке нового формата данные конвертируются во внутренний формат для работы веб-интерфейса

## Совместимость

- Новый формат полностью совместим с ParserQ
- Старый формат автоматически конвертируется в новый при сохранении
- Веб-интерфейс работает с обоими форматами без изменений